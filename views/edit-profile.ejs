<%- include('partials/header') %>

<div class="container">
  <div class="form-container-wide">
    <h1>Edit Profile</h1>

    <form action="/profile/edit" method="POST" enctype="multipart/form-data" class="profile-form">
      <div class="form-group">
        <label for="profilePhoto">Profile Photo</label>
        <% if (user.profilePhoto) { %>
          <img src="<%= user.profilePhoto %>" alt="Current photo" class="current-photo">
        <% } %>
        <input type="file" id="profilePhoto" name="profilePhoto" accept=".jpg,.jpeg,.png">
        <small>Max file size: 2MB. Accepted formats: JPG, PNG</small>
      </div>

      <div class="form-group">
        <label for="bio">Bio / Description</label>
        <textarea id="bio" name="bio" rows="4" maxlength="500"><%= user.bio || '' %></textarea>
        <small>Maximum 500 characters</small>
      </div>

      <div class="form-group">
        <label for="interests">Interests / Hobbies</label>
        <input type="text" id="interests" name="interests" 
               value="<%= user.interests ? user.interests.join(', ') : '' %>" 
               placeholder="Programming, Music, Sports">
        <small>Separate with commas</small>
      </div>

      <h3>Contact Information</h3>

      <div class="form-row">
        <div class="form-group">
          <label for="phone">Phone Number</label>
          <input type="tel" id="phone" name="phone" value="<%= user.contactInfo?.phone || '' %>">
        </div>

        <div class="form-group">
          <label for="linkedin">LinkedIn</label>
          <input type="url" id="linkedin" name="linkedin" value="<%= user.contactInfo?.linkedin || '' %>" 
                 placeholder="https://linkedin.com/in/yourname">
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="github">GitHub</label>
          <input type="url" id="github" name="github" value="<%= user.contactInfo?.github || '' %>" 
                 placeholder="https://github.com/yourname">
        </div>

        <div class="form-group">
          <label for="portfolio">Portfolio Website</label>
          <input type="url" id="portfolio" name="portfolio" value="<%= user.contactInfo?.portfolio || '' %>" 
                 placeholder="https://yourwebsite.com">
        </div>
      </div>

      <div class="form-group">
        <label for="visibility">Profile Visibility</label>
        <select id="visibility" name="visibility">
          <option value="public" <%= user.visibility === 'public' ? 'selected' : '' %>>Public - Anyone can view</option>
          <option value="university" <%= user.visibility === 'university' ? 'selected' : '' %>>University Only - Logged in students</option>
          <option value="private" <%= user.visibility === 'private' ? 'selected' : '' %>>Private - Admin only</option>
        </select>
      </div>

      <button type="submit" class="btn btn-primary btn-block">Save Changes</button>
    </form>

    <hr style="margin: 3rem 0;">

    <h2>Add Skills</h2>
    <form action="/profile/skill/add" method="POST" class="inline-form">
      <div class="form-row">
        <div class="form-group">
          <input type="text" name="name" placeholder="Skill name" required>
        </div>
        <div class="form-group">
          <input type="number" name="level" min="0" max="100" placeholder="Level (0-100)" required>
        </div>
        <button type="submit" class="btn btn-secondary">Add Skill</button>
      </div>
    </form>

    <% if (user.skills && user.skills.length > 0) { %>
      <div class="current-items">
        <h4>Current Skills:</h4>
        <ul>
          <% user.skills.forEach(skill => { %>
            <li><%= skill.name %> - <%= skill.level %>%</li>
          <% }) %>
        </ul>
      </div>
    <% } %>

    <hr style="margin: 3rem 0;">

    <h2>Add Project</h2>
    <form action="/profile/project/add" method="POST" class="project-form">
      <div class="form-group">
        <input type="text" name="name" placeholder="Project name" required>
      </div>
      <div class="form-group">
        <textarea name="description" rows="3" placeholder="Project description" required></textarea>
      </div>
      <div class="form-row">
        <div class="form-group">
          <input type="url" name="githubLink" placeholder="GitHub link">
        </div>
        <div class="form-group">
          <input type="url" name="liveLink" placeholder="Live demo link">
        </div>
      </div>
      <button type="submit" class="btn btn-secondary">Add Project</button>
    </form>

    <% if (user.projects && user.projects.length > 0) { %>
      <div class="current-items">
        <h4>Current Projects:</h4>
        <ul>
          <% user.projects.forEach(project => { %>
            <li><strong><%= project.name %></strong> - <%= project.description %></li>
          <% }) %>
        </ul>
      </div>
    <% } %>
  </div>
</div>

<%- include('partials/footer') %>